<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.lion09.pay.LionPayMapper">

<insert id="insertLionPay" parameterType="com.lion09.pay.LionPayDTO">
    INSERT INTO lionPay (userId) VALUES (#{userId})
</insert>

<insert id="insertRecharge" parameterType="com.lion09.pay.ListDTO">
    INSERT INTO recharge (userId) VALUES (#{userId})
</insert>

<update id="updateRechargeAmt" parameterType="int">
    update lionPay set rechargeAmount = #{rechargeAmount} where userId = #{userId}
</update>

<update id="updateBalData" parameterType="com.lion09.pay.LionPayDTO">
    update lionPay set balance = balance + #{rechargeAmount} where userId = #{userId}
</update>

<update id="updateAccData" parameterType="com.lion09.pay.LionPayDTO">
	update lionPay set accountNum=#{accountNum},accountName=#{accountName}
	where userId=#{userId}
</update>

<update id="updatePwdData" parameterType="String">
	update lionPay set payPwd=#{payPwd} where userId=#{userId}
</update>

<update id="resetAccData" parameterType="com.lion09.pay.LionPayDTO">
	update lionPay set accountNum=null, accountName=null where userId=#{userId}
</update>

<!-- 전체 데이터 개수 -->
<select id="getDataCount" parameterType="map" resultType="int">
	select nvl(count(*),0) from recharge
</select>

<!-- 하나의 데이터 -->
<select id="getReadData" parameterType="String" resultType="com.lion09.pay.LionPayDTO">
	select userId,accountNum,accountName,payPwd,balance from lionPay where userId=#{userId}
</select>

<select id="getBalance" parameterType="String" resultType="int">
    select balance from lionPay where userId=#{userId}
</select>

<insert id="insertData" parameterType="com.lion09.pay.ListDTO">
	insert into recharge (userId,rechargeAmount,accountName,date) values (#{userId},#{rechargeAmount},#{accountName},CURRENT_TIMESTAMP)
</insert>

<select id="getListData" parameterType="com.lion09.pay.ListDTO" resultType="com.lion09.pay.ListDTO">
	select rechargeAmount,accountName,date from recharge where userId=#{userId} ORDER BY date DESC limit 4
</select>

<select id="getLists" parameterType="hashMap" resultType="com.lion09.pay.ListDTO">
	select * from (
	select rownum rnum, data.* from(
	select rechargeAmount,accountName,date
	from recharge 
	order by date desc) data)
<![CDATA[
	where rnum>=#{start} and rnum<=#{end}
]]>
</select>

</mapper>