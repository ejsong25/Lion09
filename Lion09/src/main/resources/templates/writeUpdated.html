<!DOCTYPE html>
<html lang="en">
<head>
  
    <!-- include libraries(jQuery, bootstrap) -->
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/css/bootstrap.min.css" integrity="sha384-Vkoo8x4CGsO3+Hhxv8T/Q5PaXtkKtu6ug5TOeNV6gBiFeWPGFN9MuhOf23Q9Ifjh" crossorigin="anonymous">

    <script src="https://code.jquery.com/jquery-3.4.1.slim.min.js" integrity="sha384-J6qa4849blE2+poT4WnyKhv5vZF5SrPo0iEjwBvKU7imGFAV0wwj1yYfoRSJoZ+n" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js" integrity="sha384-Q6E9RHvbIyZFJoft+2mJbHaEWldlvI9IOYy5n3zV9zzTtmI3UksdQRVvoxMfooAo" crossorigin="anonymous"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/js/bootstrap.min.js" integrity="sha384-wfSDF2E50Y2D1uUdj0O3uMBJnjuUD4Ih7YwaYd1iqfktj0Uod8GCExl3Og8ifwB6" crossorigin="anonymous"></script>
    <link href="css/myPage.css" rel="stylesheet" />
    <link href="https://cdn.jsdelivr.net/npm/summernote@0.8.18/dist/summernote-lite.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/summernote@0.8.18/dist/summernote-lite.min.js"></script>                     

    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge" />
    <title>글쓰기</title>  

<link href="css/templatemo-style.css" rel="stylesheet" />
<link href="css/write.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.8.2/css/all.min.css" />

<link rel="stylesheet" href="writePhoto.css">




   <script type="text/javascript">
   
	   function productsPriceChange(){
	       var productsPrice = document.getElementById('productsPrice').value;
	       
	   }
	   
	   function recruitmentChange(){
	   	var recruitment = document.getElementById('recruitment').value;
	   }    
	
	   function deadLineChange(){
	   	var deadLine = document.querySelector("#deadLine").value;
	   } 
 
   </script>


</head>

<style>
@font-face {
    font-family: 'ONE-Mobile-POP';
    src: url('https://cdn.jsdelivr.net/gh/projectnoonnu/noonfonts_2105_2@1.0/ONE-Mobile-POP.woff') format('woff');
    font-weight: normal;
    font-style: normal;
}

@font-face {
    font-family: 'omyu_pretty';
    src: url('https://cdn.jsdelivr.net/gh/projectnoonnu/noonfonts_2304-01@1.0/omyu_pretty.woff2') format('woff2');
    font-weight: normal;
    font-style: normal;
}

</style>


<body style="padding-top: 5rem;">


   	<div class="container">
	<!-- Top box -->
		<!-- Logo & Site Name -->
		<div class="placeholder">
			<div class="parallax-window" data-parallax="scroll" data-image-src="img/bg.jpeg">
				<div class="tm-header">
					<div class="row tm-header-inner">
						<div class="col-md-6 col-12">
							<div class="tm-site-text-box">
								<h1 class="tm-site-title">글쓰기</h1>
  							</div>
						</div>
					</div>
				</div>
			</div>
		</div>	
	</div>
	
        <main role="main" class="container">
            
            
            <div class="tm-paging-links1">
            <form action="writeUpdated_ok" method="POST" name="myForm" enctype="multipart/form-data">
					<nav>
						<ul>
							<li class="tm-paging-item1" >
							<a href="#" class="tm-paging-link1 active">만나서 거래</a>
							<input type="hidden" name="type" value="만나서거래">
							</li>
						</ul>
					</nav>
				</div>
            
            					<div class="container" style="width: 98%;">
					<div class="image-upload" id="image-upload">
				
 					<img th:src="@{|/img/postimg/${dto.chooseFile}|}" style="border-radius: 12px; width:200px"/>
 					
				        <div class="button">
				          <span style="font-size: 5em; color: #8993a4;" id="chooseFile">
							 <!--  <i class="fas fa-camera" ></i> -->
						  </span>
				         </div>
				        <input type="file" id="chooseFile"  name="chooseFile" accept="image/*" onchange="loadFile(this)"><br/>
				        
				        <input type="button" class="profileImgBtn" value="사진변경" onclick="chooseFile_update();">
						<input type="button" class="profileImgBtn" value="사진삭제" onclick="chooseFile_delete();">
				       				  		
				       		  		
				       				  		
				      <div class="fileContainer">
				          <div class="fileInput">
				              <!-- <p>FILE NAME: </p> -->
				              <p id="fileName"></p>
				       </div>

				      </div>
				  </div>
				    
				    <div class="image-show" id="image-show"></div>
				</div>
            
            
            
            

            
               <div class="form-group form-price"></div>
                    <input type="text" class="form-control" name="title" style="border-radius:5px; width:100%; padding:5px;" th:value="${dto.title}"/>
                 
                  
                    <div class="form-group form-price"></div>
                    <select class="form-control" id="categoryId" name="categoryId"  style="border-radius:5px; width:100%; padding:5px;" th:value="${dto.categoryId}">
	                   <option value="">카테고리 선택</option>
	                   <option value="1" selected>신선식품</option>
	                   <option value="2">가공식품</option>
	                   <option value="3">의류/신발</option>
	                   <option value="4">뷰티/미용</option>
	                   <option value="5">생활/주방</option>
	                   <option value="6">스포츠/레저</option>
	                   <option value="7">도서</option>
	                   <option value="8">기타물품</option>
	               </select>
	               
	              <br/>
	              
     			 <div class="form-group form-price">
	                <input type="number" class="form-control" id="productsPrice" name="productsPrice" min="0" step="1000"
					style="border-radius:5px;width:99%;" th:value="${dto.productsPrice}" onchange="productsPriceChange();"/>
	             </div>
	             <div class="form-group form-price">
	                <input type="number" class="form-control" id="recruitment" name="recruitment" min="2" step="1" 
	                style="border-radius:5px;width:99%;" th:value="${dto.recruitment}" onchange="recruitmentChange();"/>
	             </div>
	            
  
		        <input type="text" class="form-control" name="myAddr" id="myAddr" th:value="${dto.myAddr}"
		         style="border-radius:5px; width:100%; padding:5px;" hidden/>
		         
			         
			    <!-- 마감일 작성 -->
		        	<div>
		        		<label style="font-size: 18px; color: #747474;">&nbsp;&nbsp;&nbsp;마감일을 입력해주세요.
		                <input type="datetime-local" class="form-control" name="deadLine" id="deadLine"
		                style="border-radius:5px;width:99%;" value="" onchange="deadLineChange();"/>
		          		</label>
		            </div>
	            <!-- 마감일 작성 완료 -->
			                  
				<br/><br/><br/>		


                 	
                <div class="pt-1">
                    <textarea id="summernote" name="contents" th:text="${dto.contents}"></textarea>
                </div>  
	                    <script>
             $('#summernote').summernote({
               placeholder: '게시글 내용을 작성해 주세요. (판매금지 물품은 게시가 제한 될 수 있습니다.)<br/><br/> 신뢰할 수 있는 거래를 위해 자세히 적어주세요. <br/><br/> 구매 후 공구하는 경우는 영수증 사진을 필수로 첨부해주세요',
               tabsize: 2,
               height: 400
             });
           </script>         

   
                         
                         
				    <input type="hidden" name="postId"  th:value="${dto.postId }"/> 
					<input type="hidden" name="pageNum"  th:value="${pageNum }"/>

                 
                  <br/><br/>               
                    
                <div class="pt-1 text-right">
               	
          			  <button class="qnaBtn" style="width: 70px; height: 25px;" onclick="sendIt();" >수정완료</button>
                      <button class="qnaBtn" style="width:10%; padding:5px;" th:onclick="javascript:location.href='myList';">수정취소</button>
                     
                     </form>
                    <br/><br/>
                </div>    
       
        </main>   

<script src="js/jquery.min.js"></script>
<script src="js/parallax.min.js"></script>
<script src="js/writePhoto.js"></script>
 <script type="text/javascript">

	function sendIt(){

	  	f = document.myForm;
		
    	
		str = f.title.value;
		str = str.trim();
		if(!str){
			alert("\n제목을 입력하세요.");
			f.title.focus();
			return;
		}
		f.title.value = str;
	
	

		str = f.categoryId.value;
		if(!isValidCategoryId(f.categoryId.value)){
			alert("\n카테고리를 선택하세요.");
			f.categoryId.focus();
			return;
		}
		f.categoryId.value = str;
	
	
		str = f.productsPrice.value;
		if(!isValidProductsPrice(f.productsPrice.value)){
			alert("\n가격을 입력해주세요.");
			f.productsPrice.focus();
			return;
		}
		f.productsPrice.value = str;
	
	
	
		str = f.recruitment.value;
		if(!isValidRecruitment(f.recruitment.value)){
			alert("\n모집인원을 선택해주세요.");
			f.recruitment.focus();
			return;
		}
		f.recruitment.value = str;

	
		str = f.myAddr.value;
		str = str.trim();
		if(!str){
			alert("\n위치를 입력하세요.");
			f.myAddr.focus();
			return;
		}
		f.myAddr.value = str;			
		
		str = f.contents.value;
		str = str.trim();
		if(!str){
			alert("\n내용을 입력하세요.");
			f.contents.focus();
			return;
		}
		f.contents.value = str;
	
		
		f.action = "/writeUpdated_ok";
		f.submit();
		
	}
	
	function chooseFile_update() {
		
		f = document.myForm;
		
		//파일을 선택하는 input 요소 가져오기
	    var fileInput = document.querySelector('input[name="chooseFile"]');
	    
	    //파일이 선택되었는지 여부 확인
	    if (fileInput.files.length === 0) {
	        alert('변경하실 이미지 파일을 선택해주세요.');
	        return; // 파일이 선택되지 않았을 때 form을 제출하지 않고 함수 종료
	    }
	    
		//선택한 파일의 이름 가져오기
	    var fileName = fileInput.files[0].name;

	    //허용된 파일 확장자 목록 정의
	    var allowedExtensions = ['.png', '.jpeg', '.jpg'];

	    //선택한 파일의 확장자 추출
	    var fileExtension = fileName.substring(fileName.lastIndexOf('.')).toLowerCase();

	    //허용된 확장자 목록에 있는지 확인
	    if (allowedExtensions.indexOf(fileExtension) === -1) {
	        alert('png 또는 jpg,jpeg 형식의 파일만 업로드할 수 있습니다.');
	        return; //허용되지 않은 확장자일 때 form을 제출하지 않고 함수 종료
	    }
		
	    

	    alert('게시글 이미지가 수정되었습니다');

	    f.action = "/chooseFile_update.action";
	    f.submit();

	}
	
	function chooseFile_delete() {
		
		f = document.myForm;
		
		alert('추가 이미지가 삭제되었습니다');
		
		f.action="/chooseFile_delete.action";
		f.submit();
	
	}

</script>
<script>
		$(document).ready(function(){
			// Handle click on paging links
			$('.tm-paging-link1').click(function(e){
				e.preventDefault();
				
				var page = $(this).text().toLowerCase();
				$('.tm-gallery-page').addClass('hidden');
				$('#tm-gallery-page-' + page).removeClass('hidden');
				$('.tm-paging-link1').removeClass('active');
				$(this).addClass("active");
			});
		});
	</script>
	




	
	
    </body>
</html>